# [오픈 미션] 위젯으로 키우는 용 🐉

> 나만의 미션을 설계하고 구현한다.

## 📖 프로젝트 소개

* 이 프로젝트는 우아한테크코스 프리코스 4주차 미션을 위해 진행하는 **'안드로이드 홈 스크린 위젯'** 기반의 용 키우기 게임입니다.
* 별도의 앱 실행 없이, 홈 스크린에서 간단한 터치(상호작용)를 통해 용을 육성하고, 사용자가 앱을 보지 않을 때도 용이 스스로 상태가 변하는 '살아있는' 게임을 목표로 합니다.
* **개발 기간:** 2025.11.05 ~ 2025.11.17 (2주)

## 🚀 미션 설계 의도

#### 1. 프리코스와의 연관성

프리코스 기간 중 **'계산기', '자동차 경주', '로또'** 미션을 수행하며, Kotlin 언어의 문법에 익숙해졌습니다.
또한, 객체지향 설계 원칙, TDD 접근 방식, IntelliJ 프로그램 학습, 명확한 커밋 메시지 작성 등 요구사항을 분석하고 코드로 구현하는 훈련을 했습니다.

이전 미션들이 주로 콘솔 환경에서 로직을 구현하는데 중점을 두었다면, 이번 오픈 미션에서는 프리코스에서
Kotlin 언어와 문제 해결 접근 방식을 **'안드로이드'** 라는 새로운 플랫폼에 적용하는 도전을 하고자 합니다.

#### 2. 이 주제를 선택한 이유

게임은 제가 올해 초, 처음 개발을 해보도록 만들어준 계기입니다. 게임을 만들어보고 싶어서 개발에
입문하게 되었습니다. 프리코스 과정에서 배운 Kotlin 언어로 게임을 만들어보는 것은,
제가 해보고 싶었던 일이자 생각만 해도 설레는 일입니다.

또한, '콘솔 앱 개발'에서 '안드로이드 위젯 개발'로의 도약은 저에게 큰 도전입니다.
이 도전을 위해 다음과 같은 마음가짐으로 미션에 임합니다.

* **학습 영역의 확장**  
콘솔 환경에서 익힌 Kotlin 지식을 Android UI 환경, 특히 '고전적 `RemoteViews`' 방식이 아닌, 선언형 UI를 제공하는 **`Jetpack Glance`**로 확장해 봅니다.
* **'스스로 학습'의 실천**  
프리코스에서 배운 '스스로 학습하고 적용하는 경험'을 바탕으로, 안드로이드 공식 문서와 '아이스크림 내기'
앱 튜토리얼 등을 탐색하며 새로운 기술을 주도적으로 익힙니다.
* **과정의 기록**  
2주간 완벽한 앱을 만들기보다, 새로운 기술에 도전하며 겪는 문제 해결 과정(고민, 버그, 해결책)을
`README`와 커밋 로그에 충실히 기록하는 것을 더 중요하게 생각합니다.

## 🎯 이번 미션의 도전 목표

위의 '설계 의도'를 달성하기 위해 다음과 같은 구체적인 기술 목표를 설정했습니다.

1.  **`Jetpack Glance`의 이해 (핵심 목표)** [1]
    * `AppWidgetProvider` 대신 `GlanceAppWidgetReceiver`와 `GlanceAppWidget`을 상속받아 위젯의 생명주기를 관리해 봅니다.
    * `RemoteViews`의 복잡함 대신, Jetpack Compose와 유사한 선언형 코드로 위젯 UI를 구성하고 업데이트하는 방법을 익힙니다. [1]
2.  **안정적인 위젯-앱 상호작용 및 상태 관리 구현**
    * `PendingIntent`와 `BroadcastReceiver` 조합 대신, Glance의 `actionRunCallback`을 활용하여 위젯 내 클릭 이벤트를 간결하게 처리합니다.
    * `SharedPreferences`보다 타입-안정성 및 비동기 처리가 뛰어난 `Jetpack DataStore`를 사용하여 용의 상태(레벨, 배고픔)를 기기에 저장하는 방법을 익힙니다.
3.  **'살아있는 펫'을 위한 백그라운드 로직 구현 (핵심 도전)**
    * 안드로이드의 배터리 정책(App Standby Buckets)을 준수하면서 '시간의 흐름'을 시뮬레이션하기 위해 `WorkManager`를 학습하고 적용합니다.
    * `WorkManager`가 비정기적으로 실행되더라도 [2], 마지막 업데이트 시간과의 차이를 계산하는 '타임스탬프 기반 로직'을 구현하여 드래곤의 상태가 정확하게 반영되도록 설계합니다.
4.  **프리코스 경험의 적용**
    * **(Kotlin)** 프리코스에서 배운 Kotlin의 문법과 특성(Data Class, 람다 등)을 안드로이드 프로젝트에 적용합니다.
    * **(TDD/Test)** 안드로이드 환경에서의 간단한 유닛 테스트(Unit Test)를 작성하며 TDD 방식을 흉내 내 봅니다.
    * **(Git)** 프리코스에서 연습한 의미 있는 단위의 커밋 메시지 규칙을 준수합니다.

<br>

## ✨ 주요 기능 (단계별 구현 계획)

* **[Phase 1] 핵심 로직 및 상태 저장 구현**
    * [ ] 용의 상태(예: 레벨, 배고픔, 행복도)를 관리하는 데이터 모델(Data Class) 정의
    * [ ] '먹이주기', '놀아주기', '사랑주기(메인앱)' 기능 로직을 담당할 `DragonStateCalculator` 클래스 구현
    * [ ] `Jetpack DataStore`를 사용하여 용의 상태 및 `lastUpdatedTimestamp`를 저장하고 불러오는 기능 구현
* **[Phase 2] 수동적 업데이트 (시간 경과) 구현 (핵심)**
    * [ ] `WorkManager`를 사용하여 주기적인(예: 1시간마다) 백그라운드 작업 스케줄링
    * [ ] `Worker`가 실행될 때마다 `DataStore`에서 `lastUpdatedTimestamp`를 읽어와 [3] 경과된 시간만큼 '게임 로직'(예: 배고픔 증가, 행복도 감소)을 실행하고 다시 `DataStore`에 저장하는 '타임스탬프 기반 로직' 구현
* **[Phase 3] 위젯 표시 (Read-Only)**
    * [ ] `Jetpack Glance`를 사용해 홈 스크린에 위젯 추가 기능 구현
    * [ ] `DataStore`에 저장된 용의 현재 상태(`dragon_state`)를 읽어와 `res/drawable`에 준비된 픽셀 아트 이미지(예: `dragon_idle.png`, `dragon_lonely.png`)를 위젯 UI에 표시
* **[Phase 4] 위젯 상호작용 (Read-Write)**
    * [ ] 위젯에 '먹이주기', '놀아주기' 버튼 추가
    * [ ] 각 버튼 클릭 시 `actionRunCallback`을 실행하여 [Phase 1]의 로직(예: 배고픔 감소)이 즉시 `DataStore` 상태를 업데이트하도록 구현
    * [ ] 로직 실행 후, 변경된 용의 상태가 위젯 UI에 즉시 새로고침되도록 구현
    * [ ] 특정 상태(예: `dragon_state = "needs_love"`)일 때, 위젯 클릭 시 메인 앱을 실행(`actionStartActivity`)하도록 구현 (메인 앱 접속 유도)

<br>

## 🗓️ 2주간의 개발 계획

### 1주차 (11.05 ~ 11.10): 핵심 로직 및 백그라운드 엔진 마련

* [X] **(개인 학습)** '아이스크림 내기' 튜토리얼을 통해 Android Activity 기본 구조 선행 학습 (병행)
* [ ] **(학습)** `Jetpack Glance`, `DataStore`, `WorkManager` 공식 가이드 학습
* [ ] **[Phase 1]** 프로젝트 생성 및 Git 초기 설정 (브랜치 전략 수립)
* [ ] **[Phase 1]** 용 상태 데이터 모델 및 핵심 로직(`DragonStateCalculator`) 구현
* [ ] **[Phase 1]** `DataStore` 연동 테스트 (TDD 시도)
* [ ] **[Phase 2]** `WorkManager` 스케줄링 및 '타임스탬프 기반' 수동적 업데이트 로직 구현

### 2주차 (11.11 ~ 11.17): 위젯 UI 및 상호작용 완성

* [ ] **[Phase 3]** `Jetpack Glance`로 기본 위젯 생성 및 `DataStore`의 상태를 읽어와 표시 (Read-Only)
* [ ] **[Phase 4]** 위젯에 버튼 추가 및 `actionRunCallback`을 사용한 이벤트 처리 구현
* [ ] **[Phase 4]** 버튼 클릭 시 `DataStore` 변경 및 UI 즉시 새로고침 로직 구현
* [ ] **[Phase 4]** 픽셀 아트 이미지 리소스 추가 및 상태(`dragon_state`)에 따라 이미지 변경
* [ ] **[Phase 4]** 메인 앱 접속 유도 로직 구현
* [ ] 버그 테스트 및 코드 리팩토링
* [ ] README 최종 정리 및 미션 제출

<br>

## 🛠️ 사용 기술

* **Language:** Kotlin
* **IDE:** Android Studio
* **Core:** **`Jetpack Glance`** (for UI & Interaction)
* **Background:** **`WorkManager`** (for Passive Game Loop)
* **Data:** **`Jetpack DataStore`** (for State Persistence)
* **Version Control:** Git, GitHub

<br>

## ✍️ 개발 로그

* **11.05:** `Android Studio`를 설치하고, '아이스크림 내기' 어플 제작 학습을 시작함.
* **11.07:** `activity_main.xml`을 이용해서 UI 배치하는 것을 학습함.
* **11.08:** 안드로이드 스튜디오로 '아이스크림 내기' 어플을 제작하는 도중에, 노트북이 배터리 부족으로 꺼지는 상황이 생겼음.
  캐시 무효화도 해보고, 다양한 시도를 해보았지만 해당 프로젝트를 실행만 하면 프로그램이 먹통이 됨.
  따라서 강의를 따라하는 것은 이곳에서 멈추고, 바로 본 프로젝트로 들어가기로 하였음.

<br>

## 💬 커밋 컨벤션

* `feat`: 새로운 기능 추가
* `fix`: 버그 수정
* `docs`: 문서 수정 (README 등)
* `refactor`: 코드 리팩토링
* `test`: 테스트 코드 추가/수정
* `chore`: 빌드 설정, 기타 잡무
